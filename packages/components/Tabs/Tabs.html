<div class="tabs">
  {#if tabs && tabs.length}
  <table class="tab-navigation">
    <tr>
      {#each tabs as tab, index}
      <td on:click="_changeTab(index)" class:active="index == currentIndex">
        {tab.title}
        <div class="line"></div>
      </td>
      {/each}
    </tr>
  </table>

  {/if}

  <div class="tabs-paine-container" ref:container>
    <slot></slot>
  </div>
</div>

<script>
  export default {
    data() {
      return {
        currentIndex: 0,
      };
    },
    oncreate() {
      const tabs = [].filter.call(this.refs.container.children, element =>
        element.classList.contains('tab-pane'),
      );

      this.set({ tabs });
      this._changeTab(this.get().currentIndex);
    },
    methods: {
      _changeTab(index) {
        const { tabs, currentIndex } = this.get();
        tabs[currentIndex].hidden = true;
        tabs[index].hidden = false;
        this.fire('change', { currentIndex: index });
        this.set({ currentIndex: index });
      },
    },
  };
</script>

<style type="text/postcss">
  @import '@mamba/styles/theme.pcss';

  .tab-navigation {
    height: $tab-height;
    width: 100%;
    background-color: $tab-navigation-bg;
    overflow: hidden;
    table-layout: fixed;

    td {
      vertical-align: middle;
      text-align: center;
      font-size: 13px;
      color: $tab-label-color;
      position: relative;
      height: 100%;

      .line {
        position: absolute;
        bottom: 0;
        width: 100%;
        height: 3px;
        content: '';
      }
    }

    td.active {
      font-weight: bold;

      .line {
        background-color: $tab-line-color;
      }
    }
  }

  .tabs-paine-container {
    width: 100%;
    position: relative;
  }
</style>
